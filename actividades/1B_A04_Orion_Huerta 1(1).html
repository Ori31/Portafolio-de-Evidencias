<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Conversiones - Números Complejos</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tiny5&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
  <style>
    /* ==================== RESET BÁSICO ==================== */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    /* ==================== ESTRUCTURA GENERAL (Estilo Oscuro/Neón) ==================== */
    .tiny5-regular {
        font-family: "Tiny5", sans-serif;
        font-weight: 400;
        font-style: normal;
    }

    body {
        /* Fondo similar al de referencia (Negro + rejilla violeta) */
        margin: 0;
        font-family: 'Tiny5', sans-serif;
        text-align: center;
        background-color: black;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        padding: 30px 20px;
        background-image:
            linear-gradient(rgba(139, 0, 139, 0.1) 1px, transparent 1px),
            linear-gradient(90deg, rgba(139, 0, 139, 0.1) 1px, transparent 1px);
        background-size: 20px 20px;
    }

    .container {
        /* Contenedor principal oscuro con sombra "neón" */
        max-width: 900px;
        margin: 0 auto 30px auto;
        background: #111111;
        border-radius: 25px; /* Más redondeado */
        box-shadow: 0 0 20px rgba(71, 8, 129, 0.8), 0 0 50px rgba(71, 8, 129, 0.5); /* Sombra intensa violeta */
        padding: 30px;
        width: 100%;
        border: 1px solid #333333;
        position: relative;
        overflow: hidden;
    }

    /* Efecto de escaneo (copiado del original) */
    .container::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(0, 191, 255, 0.2), transparent);
        animation: scan 4s linear infinite;
    }

    @keyframes scan {
        0% { left: -100%; }
        100% { left: 100%; }
    }


    /* ==================== ENCABEZADOS ==================== */
    h1 {
        /* Color similar al h1 original (violeta oscuro) */
        text-align: center;
        margin: 0;
        padding: 0;
        font-size: 60px; /* Tamaño grande */
        color: rgb(71, 8, 129);
        margin-bottom: 5px;
        text-shadow: 0 0 10px rgba(71, 8, 129, 0.8);
    }

    h3 {
        /* Color similar al p/h3 original (turquesa) */
        font-size: 25px;
        color: turquoise;
        margin-bottom: 30px;
    }

    h2 {
        /* Color similar al h2 original (violeta oscuro) */
        color: rgb(71, 8, 129);
        font-size: 30px; /* Tamaño más grande */
        margin-bottom: 20px;
        text-shadow: 0 0 5px rgba(71, 8, 129, 0.5);
    }

    .instructions {
        /* Fondo más claro con borde y color de texto que contraste */
        background-color: rgba(168, 203, 234, 0.2); /* Azul claro semi-transparente */
        padding: 15px 20px;
        border-radius: 15px;
        margin-bottom: 25px;
        font-size: 18px;
        color: white; /* Texto blanco para el fondo oscuro */
        border: 1px solid turquoise; /* Borde turquesa para destacar */
    }

    .instructions strong {
        color: turquoise; /* Título de instrucción en turquesa */
    }

    .instructions ul {
        margin-left: 20px;
        margin-top: 10px;
        color: rgb(168, 203, 234); /* Color de lista más suave */
        list-style-type: none; /* Quitamos viñetas por defecto */
    }

    .instructions li {
        margin-bottom: 5px;
        font-size: 20px; /* Hacemos el texto más grande (como li original) */
    }

    /* ==================== SECCIONES DE FORMULARIO ==================== */
    .form-section {
        /* Similar a .recuadro: fondo semi-transparente y sombra */
        margin-bottom: 25px;
        border: 1px solid rgba(168, 203, 234, 0.5);
        border-radius: 25px; /* Más redondeado */
        padding: 20px;
        background: rgba(168, 203, 234, 0.15); /* Fondo claro semi-transparente */
        box-shadow: 5px 10px 15px rgba(0, 0, 0, 0.5); /* Sombra de recuadro */
    }

    .input-group {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
        justify-content: center; /* Centrar el grupo de entradas */
    }

    .input-group:last-child {
        margin-bottom: 0;
    }

    /* ==================== ETIQUETAS Y OPERADORES ==================== */
    label {
        min-width: 20px;
        font-weight: 500;
        color: white; /* Etiquetas blancas */
        font-size: 20px;
    }

    .operator {
        font-size: 20px;
        color: turquoise; /* Operadores en turquesa */
        margin: 0 5px;
        font-weight: 500;
    }

    /* ==================== CAMPOS DE ENTRADA ==================== */
    input[type="text"] {
        width: 120px;
        padding: 10px 15px;
        border: 2px solid turquoise; /* Borde turquesa */
        border-radius: 8px;
        font-size: 18px;
        text-align: center;
        background-color: #333333; /* Fondo oscuro para los inputs */
        color: white; /* Texto de input blanco */
    }

    input[type="text"]:focus {
        outline: none;
        border-color: rgb(71, 8, 129); /* Borde violeta al enfocar */
        box-shadow: 0 0 8px rgba(71, 8, 129, 0.8); /* Sombra violeta al enfocar */
    }

    input[readonly] {
        background-color: #222222 !important;
        cursor: not-allowed;
    }

    /* ==================== RESULTADOS ==================== */
    .result {
        /* Estilo de resultado que destaque */
        background-color: rgba(0, 0, 0, 0.3); /* Fondo muy oscuro semi-transparente */
        padding: 15px;
        border-radius: 10px;
        border-left: 5px solid turquoise; /* Borde vertical turquesa */
        font-family: 'Courier New', monospace;
        font-size: 20px;
        color: turquoise; /* Texto de resultado en turquesa */
        min-height: 50px;
        display: flex;
        align-items: center;
        font-weight: bold;
        justify-content: center;
        margin-top: 15px;
        box-shadow: inset 0 0 5px rgba(0, 191, 255, 0.5); /* Sombra interna para efecto de pantalla */
    }

    /* ==================== BOTÓN LIMPIAR ==================== */
    .clear-btn {
        /* Estilo de botón de acción: color violeta */
        background-color: rgb(71, 8, 129);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 20px;
        margin-top: 30px;
        display: block;
        margin-left: auto;
        margin-right: auto;
        font-weight: 500;
        border: 2px solid turquoise; /* Borde turquesa */
        box-shadow: 0 5px 15px rgba(71, 8, 129, 0.6);
        font-family: 'Tiny5', sans-serif;
        text-shadow: 0 0 5px black;
    }

    .clear-btn:hover {
        background-color: rgb(100, 20, 150);
        transform: translateY(-2px);
        box-shadow: 0 7px 20px rgba(71, 8, 129, 0.9);
    }
</style>
</head>

<body>
    <div class="container">
        <h1>Calculadora de Conversiones de Números Complejos</h1>
        <h3>Tecnologico de software - Sergio Orion Huerta Martinez - Fundamentos de algebra - 1B</h3> 
        <div class="instructions">
            <strong>Instrucciones:</strong>
            <ul>
                <li>Ingresa un número complejo en cualquiera de las tres
                    formas</li>
                <li>Las otras formas se calcularán automáticamente</li>
                <li>Los ángulos se expresan en radianes y en múltiplos de
                    pi cuando es posible</li>
                <li>Para ángulos puedes usar: pi, pi/2, pi/4, pi/3, pi/6,
                    2*pi, etc.</li>
                <li>Para raíces cuadradas puedes usar: sqrt(2), sqrt(3),
                    sqrt(5), etc.</li>
                <li>Usa números decimales (ejemplo: 1.5, -2.7, 0.5)</li>
            </ul>
        </div>
    </div>
    <br>
    <!-- Forma Cartesiana -->
    <div class="form-section">
        <h2>Forma Cartesiana: a + bi</h2>
        <div class="input-group">
            <label>z =</label>
            <input type="text" id="real" placeholder="a (ej: sqrt(2))">
            <span class="operator">+</span>
            <input type="text" id="imag" placeholder="b (ej: sqrt(3))">
            <span class="operator">i</span>
        </div>
        <div class="result" id="cartesian-result">Ingresa los valores
            arriba</div>
    </div>
    <!-- Forma Polar -->
    <div class="form-section">
        <h2>Forma Polar: r(cos θ + i sin θ)</h2>
        <div class="input-group">
            <label>z =</label>
            <input type="text" id="modulus" placeholder="r (ej: sqrt(2))">
            <span class="operator">(cos</span>
            <input type="text" id="angle" placeholder="θ (ej: pi/2)">
            <span class="operator">+ i sin</span>
            <input type="text" id="angle2" placeholder="θ" readonly style="background: #f0f0f0;">
            <span class="operator">)</span>
        </div>
        <div class="result" id="polar-result">Ingresa los valores arriba</div>
    </div>

    <!-- Forma Exponencial -->
    <div class="form-section">
        <h2>Forma Exponencial: re^(iθ)</h2>
        <div class="input-group">
            <label>z =</label>
            <input type="text" id="exp-modulus" placeholder="r (ej: sqrt(5))">
            <span class="operator">e^(i*</span>
            <input type="text" id="exp-angle" placeholder="θ (ej: pi/4)">
            <span class="operator">)</span>
        </div>
        <div class="result" id="exponential-result">Ingresa los valores
            arriba</div>
    </div>
    <button class="clear-btn" onclick="clearAll()">Limpiar Todo</button>
    <button><a href="../index.html"> Regresar </a></button>
</body>
<script>

    /**
     * CALCULADORA DE CONVERSIONES DE NÚMEROS COMPLEJOS
     * Permite conversión entre forma cartesiana, polar y exponencial
     * Soporta fracciones, raíces cuadradas y múltiplos de pi
     */

    // ============================================================================
    // VARIABLES GLOBALES
    // ============================================================================

    let isUpdating = false; // Previene bucles infinitos durante actualizaciones

    // ============================================================================
    // FUNCIONES DE PARSEO
    // ============================================================================

    /**
     * Convierte una cadena de texto a número, soportando expresiones matemáticas
     * @param {string|number} input - Entrada del usuario
     * @returns {number} - Resultado numérico
     */
    function parseNumber(input) {
        // Manejar casos vacíos o nulos
        if (!input && input !== 0) return 0;

        const inputStr = input.toString().trim();
        if (!inputStr) return 0;

        // Preparar expresión reemplazando funciones matemáticas
        let expression = inputStr
            .replace(/sqrt\s*\(/gi, 'Math.sqrt(')  // sqrt(2) → Math.sqrt(2)
            .replace(/pi\b/gi, 'Math.PI');         // pi → Math.PI

        try {
            // Evaluar expresión de forma segura
            const result = Function('"use strict"; return (' + expression + ')')();

            // Verificar que el resultado sea válido
            if (isNaN(result) || !isFinite(result)) {
                return 0;
            }

            return result;
        } catch (error) {
            // En caso de error, retornar 0
            return 0;
        }
    }

    /**
     * Convierte una cadena de texto a ángulo en radianes
     * @param {string|number} input - Entrada del usuario
     * @returns {number} - Ángulo en radianes
     */
    function parseAngle(input) {
        return parseNumber(input); // Usa la misma lógica que parseNumber
    }

    // ============================================================================
    // FUNCIONES DE FORMATO Y VISUALIZACIÓN
    // ============================================================================

    /**
     * Convierte un ángulo en radianes a su representación en múltiplos de pi
     * @param {number} angle - Ángulo en radianes
     * @returns {string} - Representación en formato pi
     */
    function angleToPI(angle) {
        if (Math.abs(angle) < 1e-8) return "0";

        // Múltiplos comunes de pi
        const piMultiples = [
            { value: Math.PI, text: "pi" },
            { value: Math.PI / 2, text: "pi/2" },
            { value: Math.PI / 3, text: "pi/3" },
            { value: Math.PI / 4, text: "pi/4" },
            { value: Math.PI / 6, text: "pi/6" },
            { value: 2 * Math.PI, text: "2*pi" },
            { value: 3 * Math.PI / 2, text: "3*pi/2" },
            { value: 2 * Math.PI / 3, text: "2*pi/3" },
            { value: 3 * Math.PI / 4, text: "3*pi/4" },
            { value: 5 * Math.PI / 6, text: "5*pi/6" },
            { value: 5 * Math.PI / 4, text: "5*pi/4" },
            { value: 4 * Math.PI / 3, text: "4*pi/3" },
            { value: 5 * Math.PI / 3, text: "5*pi/3" },
            { value: 7 * Math.PI / 4, text: "7*pi/4" },
            // Valores negativos
            { value: -Math.PI, text: "-pi" },
            { value: -Math.PI / 2, text: "-pi/2" },
            { value: -Math.PI / 3, text: "-pi/3" },
            { value: -Math.PI / 4, text: "-pi/4" },
            { value: -Math.PI / 6, text: "-pi/6" },
            { value: -2 * Math.PI, text: "-2*pi" },
            { value: -3 * Math.PI / 2, text: "-3*pi/2" },
            { value: -2 * Math.PI / 3, text: "-2*pi/3" },
            { value: -3 * Math.PI / 4, text: "-3*pi/4" },
            { value: -5 * Math.PI / 6, text: "-5*pi/6" }
        ];

        // Buscar coincidencia exacta
        for (let pm of piMultiples) {
            if (Math.abs(angle - pm.value) < 1e-8) {
                return pm.text;
            }
        }

        // Intentar expresar como fracción de pi
        const ratio = angle / Math.PI;

        // Múltiplo entero de pi
        if (Math.abs(ratio - Math.round(ratio)) < 1e-8) {
            const intRatio = Math.round(ratio);
            if (intRatio === 1) return "pi";
            if (intRatio === -1) return "-pi";
            if (intRatio === 0) return "0";
            return intRatio + "*pi";
        }

        // Fracciones simples de pi
        const denominators = [2, 3, 4, 6, 8, 12];
        for (let den of denominators) {
            const num = ratio * den;
            if (Math.abs(num - Math.round(num)) < 1e-8) {
                const intNum = Math.round(num);
                if (intNum === 0) return "0";
                if (den === 1) {
                    return intNum === 1 ? "pi" : intNum === -1 ? "-pi" : intNum + "*pi";
                }
                if (intNum === 1) return "pi/" + den;
                if (intNum === -1) return "-pi/" + den;
                return intNum + "*pi/" + den;
            }
        }

        // Si no se puede expresar como múltiplo de pi, usar decimal
        return angle.toFixed(6);
    }

    /**
     * Formatea un número mostrando fracciones y raíces cuando sea posible
     * @param {number} num - Número a formatear
     * @returns {string} - Representación formateada
     */
    function formatNumber(num) {
        if (Math.abs(num) < 1e-10) return "0";

        // Raíces cuadradas comunes
        const sqrtValues = [
            { value: Math.sqrt(2), text: "√2" },
            { value: Math.sqrt(3), text: "√3" },
            { value: Math.sqrt(5), text: "√5" },
            { value: Math.sqrt(6), text: "√6" },
            { value: Math.sqrt(7), text: "√7" },
            { value: Math.sqrt(8), text: "2√2" },
            { value: Math.sqrt(12), text: "2√3" },
            { value: Math.sqrt(18), text: "3√2" },
            { value: Math.sqrt(27), text: "3√3" },
            { value: Math.sqrt(2) / 2, text: "√2/2" },
            { value: Math.sqrt(3) / 2, text: "√3/2" },
            { value: Math.sqrt(3) / 3, text: "√3/3" },
            { value: -Math.sqrt(2), text: "-√2" },
            { value: -Math.sqrt(3), text: "-√3" },
            { value: -Math.sqrt(2) / 2, text: "-√2/2" },
            { value: -Math.sqrt(3) / 2, text: "-√3/2" },
            { value: -Math.sqrt(3) / 3, text: "-√3/3" }
        ];

        // Verificar raíces
        for (let sv of sqrtValues) {
            if (Math.abs(num - sv.value) < 1e-8) {
                return sv.text;
            }
        }

        // Fracciones comunes
        const fractions = [
            { value: 1 / 2, text: "1/2" },
            { value: 1 / 3, text: "1/3" },
            { value: 2 / 3, text: "2/3" },
            { value: 1 / 4, text: "1/4" },
            { value: 3 / 4, text: "3/4" },
            { value: 1 / 6, text: "1/6" },
            { value: 5 / 6, text: "5/6" },
            { value: 1 / 8, text: "1/8" },
            { value: 3 / 8, text: "3/8" },
            { value: 5 / 8, text: "5/8" },
            { value: 7 / 8, text: "7/8" },
            { value: -1 / 2, text: "-1/2" },
            { value: -1 / 3, text: "-1/3" },
            { value: -2 / 3, text: "-2/3" },
            { value: -1 / 4, text: "-1/4" },
            { value: -3 / 4, text: "-3/4" }
        ];

        // Verificar fracciones
        for (let frac of fractions) {
            if (Math.abs(num - frac.value) < 1e-8) {
                return frac.text;
            }
        }

        // Enteros
        if (Math.abs(num - Math.round(num)) < 1e-8) {
            return Math.round(num).toString();
        }

        // Decimal con precisión limitada
        return parseFloat(num.toFixed(6)).toString();
    }

    // ============================================================================
    // FUNCIONES MATEMÁTICAS AUXILIARES
    // ============================================================================

    /**
     * Normaliza un ángulo al rango (-π, π]
     * @param {number} angle - Ángulo en radianes
     * @returns {number} - Ángulo normalizado
     */
    function normalizeAngle(angle) {
        while (angle > Math.PI) angle -= 2 * Math.PI;
        while (angle <= -Math.PI) angle += 2 * Math.PI;
        return angle;
    }

    // ============================================================================
    // FUNCIONES DE ACTUALIZACIÓN
    // ============================================================================

    /**
     * Actualiza todas las formas cuando se modifica la forma cartesiana
     */
    function updateFromCartesian() {
        if (isUpdating) return;
        isUpdating = true;

        // Obtener valores de los campos
        const real = parseNumber(document.getElementById('real').value) || 0;
        const imag = parseNumber(document.getElementById('imag').value) || 0;

        // Calcular módulo y argumento
        const modulus = Math.sqrt(real * real + imag * imag);
        let angle = Math.atan2(imag, real);
        angle = normalizeAngle(angle);

        // Actualizar forma polar
        const modulusFormatted = formatNumber(modulus);
        const angleFormatted = angleToPI(angle);

        document.getElementById('modulus').value = modulusFormatted;
        document.getElementById('angle').value = angleFormatted;
        document.getElementById('angle2').value = angleFormatted;

        // Actualizar forma exponencial
        document.getElementById('exp-modulus').value = modulusFormatted;
        document.getElementById('exp-angle').value = angleFormatted;

        // Actualizar resultados mostrados
        updateResults(real, imag, modulus, angle);

        isUpdating = false;
    }

    /**
     * Actualiza todas las formas cuando se modifica la forma polar
     */
    function updateFromPolar() {
        if (isUpdating) return;
        isUpdating = true;

        // Obtener valores de los campos
        const modulus = parseNumber(document.getElementById('modulus').value) || 0;
        const angle = parseAngle(document.getElementById('angle').value) || 0;
        const normalizedAngle = normalizeAngle(angle);

        // Sincronizar segundo campo de ángulo
        const angleFormatted = angleToPI(normalizedAngle);
        document.getElementById('angle2').value = angleFormatted;

        // Calcular coordenadas cartesianas
        const real = modulus * Math.cos(normalizedAngle);
        const imag = modulus * Math.sin(normalizedAngle);

        // Actualizar forma cartesiana
        document.getElementById('real').value = formatNumber(real);
        document.getElementById('imag').value = formatNumber(imag);

        // Actualizar forma exponencial
        document.getElementById('exp-modulus').value = formatNumber(modulus);
        document.getElementById('exp-angle').value = angleFormatted;

        // Actualizar resultados mostrados
        updateResults(real, imag, modulus, normalizedAngle);

        isUpdating = false;
    }

    /**
     * Actualiza todas las formas cuando se modifica la forma exponencial
     */
    function updateFromExponential() {
        if (isUpdating) return;
        isUpdating = true;

        // Obtener valores de los campos
        const modulus = parseNumber(document.getElementById('exp-modulus').value) || 0;
        const angle = parseAngle(document.getElementById('exp-angle').value) || 0;
        const normalizedAngle = normalizeAngle(angle);

        // Calcular coordenadas cartesianas
        const real = modulus * Math.cos(normalizedAngle);
        const imag = modulus * Math.sin(normalizedAngle);

        // Actualizar forma cartesiana
        document.getElementById('real').value = formatNumber(real);
        document.getElementById('imag').value = formatNumber(imag);

        // Actualizar forma polar
        const angleFormatted = angleToPI(normalizedAngle);
        document.getElementById('modulus').value = formatNumber(modulus);
        document.getElementById('angle').value = angleFormatted;
        document.getElementById('angle2').value = angleFormatted;

        // Actualizar resultados mostrados
        updateResults(real, imag, modulus, normalizedAngle);

        isUpdating = false;
    }

    /**
     * Actualiza los resultados mostrados en todas las secciones
     * @param {number} real - Parte real
     * @param {number} imag - Parte imaginaria  
     * @param {number} modulus - Módulo
     * @param {number} angle - Argumento en radianes
     */
    function updateResults(real, imag, modulus, angle) {
        const angleText = angleToPI(angle);

        // Resultado cartesiano
        let cartesianText = "";
        if (real !== 0 || imag !== 0) {
            if (real !== 0) {
                cartesianText += formatNumber(real);
            }
            if (imag > 0) {
                cartesianText += (real !== 0 ? " + " : "");
                if (imag === 1) {
                    cartesianText += "i";
                } else {
                    cartesianText += formatNumber(imag) + "i";
                }
            } else if (imag < 0) {
                cartesianText += " - ";
                if (imag === -1) {
                    cartesianText += "i";
                } else {
                    cartesianText += formatNumber(-imag) + "i";
                }
            }
            if (cartesianText === "") cartesianText = "0";
        } else {
            cartesianText = "0";
        }
        document.getElementById('cartesian-result').textContent = "z = " + cartesianText;

        // Resultado polar
        let polarText = "";
        if (modulus !== 0) {
            polarText = formatNumber(modulus) + "(cos(" + angleText + ") + i sin(" + angleText + "))";
        } else {
            polarText = "0";
        }
        document.getElementById('polar-result').textContent = "z = " + polarText;

        // Resultado exponencial
        let expText = "";
        if (modulus !== 0) {
            expText = formatNumber(modulus) + "e^(i*" + angleText + ")";
        } else {
            expText = "0";
        }
        document.getElementById('exponential-result').textContent = "z = " + expText;
    }

    // ============================================================================
    // FUNCIONES AUXILIARES
    // ============================================================================

    /**
     * Limpia todos los campos de entrada y resultados
     */
    function clearAll() {
        // Limpiar todos los campos de entrada
        const inputs = document.querySelectorAll('input[type="text"], input[type="number"]');
        inputs.forEach(input => input.value = '');

        // Limpiar todos los resultados
        const results = document.querySelectorAll('.result');
        results.forEach(result => result.textContent = 'Ingresa los valores arriba');
    }

    // ============================================================================
    // INICIALIZACIÓN Y EVENT LISTENERS
    // ============================================================================

    /**
     * Configura los event listeners cuando el DOM está listo
     */
    document.addEventListener('DOMContentLoaded', function () {
        // Event listeners para forma cartesiana
        document.getElementById('real').addEventListener('input', updateFromCartesian);
        document.getElementById('imag').addEventListener('input', updateFromCartesian);

        // Event listeners para forma polar
        document.getElementById('modulus').addEventListener('input', updateFromPolar);
        document.getElementById('angle').addEventListener('input', function () {
            document.getElementById('angle2').value = this.value;
            updateFromPolar();
        });

        // Event listeners para forma exponencial
        document.getElementById('exp-modulus').addEventListener('input', updateFromExponential);
        document.getElementById('exp-angle').addEventListener('input', updateFromExponential);
    });
</script>

</html>